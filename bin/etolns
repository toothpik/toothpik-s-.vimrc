#!/usr/bin/python
#  elapsed time, one line, no seconds
from datetime import datetime
from pytz import timezone
from sys import argv, exit
#
#  f and s are the first and second dates
#  f1 and s1 are the time-zone aware versions
#
ctz = timezone('US/Central')
dfm = "%Y-%b-%d %H:%M"   #  date format
hma = len(argv)          #  how many arguments?
if hma < 3:
    if hma == 2:
        s = datetime.now()
        s = s.replace(second = 0, microsecond = 0)
        s1 = ctz.localize(s)
        try:
            f = datetime.strptime(argv[1], dfm)
            f1 = ctz.localize(f)
        except ValueError:
            print "cannot parse %s as datetime" % argv[1]
            exit(1)
    else:
        print "etolns requires at least one datetime arg"
        exit(1)
else:
    try:
        f = datetime.strptime(argv[1], dfm)
        s = datetime.strptime(argv[2], dfm)
    except ValueError:
        print "cannot parse %s or %s as datetime" % (argv[1], argv[2])
        exit(1)
    f1 = ctz.localize(f)
    s1 = ctz.localize(s)

fs = f1.strftime(dfm)
ss = s1.strftime(dfm)

if s1 > f1:
    d = s1 - f1
else:
    d = f1 - s1
    (fs, ss) = (ss, fs)

hours = d.seconds / 3600
min = (d.seconds - hours * 3600) / 60

if d.days > 0:
    print "%s  to  %s  is  %2d dy %2d hr %2d mn" % (fs, ss, d.days, hours, min)
elif hours > 0:
    print "%s  to  %s  is        %2d hr %2d mn" % (fs, ss, hours, min)
else:
    print "%s  to  %s  is              %2d mn" % (fs, ss, min)
